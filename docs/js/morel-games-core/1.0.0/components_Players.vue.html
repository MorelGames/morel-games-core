<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/Players.vue</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/Players.vue</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>&lt;template>
  &lt;nav class="panel morel-players-list">
    &lt;div class="panel-block" v-for="(player, i) in sorted_players" :key="i">
      &lt;span class="panel-icon">
        &lt;!--
          @slot For each player, this slot contains the left icon.
          @binding {object} player The player associated with this icon.
        -->
        &lt;slot name="icon" v-bind:player="player">
          &lt;b-icon
            pack="fas"
            icon="user-alt-slash"
            size="is-small"
            v-if="!player.online"
            key="ready"
          >&lt;/b-icon>
          &lt;b-icon
            pack="fas"
            icon="check"
            size="is-small"
            v-else-if="player.ready"
            key="ready"
          >&lt;/b-icon>
          &lt;b-icon
            pack="fas"
            icon="hourglass-half"
            size="is-small"
            v-else
            key="not-ready"
          >&lt;/b-icon>
        &lt;/slot>
      &lt;/span>

      &lt;div class="panel-block-main">
        &lt;!--
          @slot For each player, this slot contains the main label (by default,
                the player name and a “(you)” mark).
          @binding {object} player The player.
        -->
        &lt;slot name="label" v-bind:player="player">
          &lt;span
            v-bind:class="{
              'is-offline': !player.online
            }"
            >{{ player.pseudonym }}&lt;/span
          >
          &lt;span class="is-size-7 ourself-mark" v-if="player.ourself">{{ $t('(you)') }}&lt;/span>
        &lt;/slot>
      &lt;/div>

      &lt;!--
        @slot For each player, this slot contains additional control button, or
              any other content displayed to the right of the player's line.
              You can use `morel-player-action` to add buttons easily.
              You can disable default controls (kick, master) with the
              `default-icons` prop (set it to `false`).
        @binding {object} player The player associated with this control button.
      -->
      &lt;slot name="actions" v-bind:player="player" />

      &lt;template v-if="defaultIcons">
        &lt;morel-player-action
          :label="$t('Kick this player')"
          icon="user-alt-slash"
          v-if="we_are_master &amp;&amp; !player.master &amp;&amp; player.online"
          @click="kick_player(player.uuid)" />
        &lt;morel-player-action
          :label="player.master ? $t('Game Master') : $t('Promote as Game Master')"
          icon="user-shield"
          :permanent="player.master"
          v-if="player.master || (we_are_master &amp;&amp; player.online)"
          @click="switch_master(player.uuid)" />
      &lt;/template>
    &lt;/div>
  &lt;/nav>
&lt;/template>

&lt;script>
import { mapState, mapGetters } from "vuex"
import PlayerAction from './PlayerAction.vue'

/**
 * This components displays the players list, plus actions on them if the player
 * is master. You can add your own action in a slot.
 */
export default {
  props: {
    /**
     * If true, will include all default icons (kick and game master).
     */
    "default-icons": {
      type: Boolean,
      default: true
    },

    /**
     * In the kick confirmation dialog, the title of the popup. {name} will be
     * replaced by the kicked player's name. Accepts HTML.
     * If null, will remove the title.
     */
    "kick-confirm-title": {
      type: String,
      default: ""
    },

    /**
     * In the kick confirmation dialog, the main message of the popup. {name}
     * will be replaced by the kicked player's name. Accepts HTML.
     * If null, will remove the message.
     */
    "kick-confirm-message": {
      type: String,
      default: ""
    },

    /**
     * In the kick confirmation dialog, another message displayed in gray under
     * the main message. {name} will be replaced by the kicked player's name.
     * Accepts HTML.
     * If null, will remove the help.
     */
    "kick-confirm-help": {
      type: String,
      default: ""
    },

    /**
     * In the kick confirmation dialog, the label of the confirmation dialog
     * button to kick the player. {name} will be replaced by the kicked player's
     * name.
     */
    "kick-confirm-button-yes": {
      type: String,
      default: ""
    },

    /**
     * In the kick confirmation dialog, the label of the confirmation dialog
     * button to cancel the kick. {name} will be replaced by the kicked player's
     * name.
     */
    "kick-confirm-button-no": {
      type: String,
      default: ""
    },

    /**
     * In the switch master confirmation dialog, the title of the popup.
     * {name} will be replaced by the new master player's name. Accepts HTML.
     * If null, will remove the title.
     */
    "master-confirm-title": {
      type: String,
      default: ""
    },

    /**
     * In the switch master confirmation dialog, the main message of the popup.
     * {name} will be replaced by the new master player's name. Accepts HTML.
     * If null, will remove the message.
     */
    "master-confirm-message": {
      type: String,
      default: ""
    },

    /**
     * In the switch master confirmation dialog, another message displayed in
     * gray under the main message. {name} will be replaced by the new master
     * player's name. Accepts HTML.
     * If null, will remove the help.
     */
    "master-confirm-help": {
      type: String,
      default: ""
    },

    /**
     * In the switch master confirmation dialog, the label of the confirmation
     * dialog button to masterize the player. {name} will be replaced by the new
     * master player's name.
     */
    "master-confirm-button-yes": {
      type: String,
      default: ""
    },

    /**
     * In the switch master confirmation dialog, the label of the confirmation
     * dialog button to cancel the masterization. {name} will be replaced by the
     * kicked player's name.
     */
    "master-confirm-button-no": {
      type: String,
      default: ""
    },
  },
  computed: {
    ...mapState('morel', {
      players: state => state.players,
      we_are_master: state => state.master,
      our_uuid: state => state.uuid,
      locked: state => state.locked
    }),
    ...mapGetters('morel', {
      sorted_players: 'players_list_sorted',
      players_count: 'players_count'
    })
  },
  methods: {
    replace_name(text, def, name) {
      return (text != null ? (text || def) : '').replace(/{name}/g, name)
    },
    switch_master(uuid) {
      if (!this.we_are_master || uuid === this.our_uuid) return

      let player = this.players[uuid]
      if (!player || !player.online) return

      const $t = this.$t.bind(this)

      let message = this.replace_name(
        this.masterConfirmMessage,
        $t("&lt;strong>{name}&lt;/strong> will be able to manage the game and its configuration. You'll lose those powers."),
        player.pseudonym
      )

      let help = this.replace_name(
        this.masterConfirmHelp,
        $t("The game master cannot cheat, only manage the game. It can also kick players and lock the game."),
        player.pseudonym
      )

      this.$buefy.dialog.confirm({
        title: this.replace_name(
          this.masterConfirmTitle,
          $t("Promote {name}?"),
          player.pseudonym
        ),
        message: `${message}&lt;br />&lt;br />&lt;span class="has-text-grey">${help}&lt;/span>`,
        confirmText: this.replace_name(
          this.masterConfirmButtonYes,
          $t("Promote"),
          player.pseudonym
        ),
        cancelText: this.replace_name(
          this.masterConfirmButtonNo,
          $t("Stay Game Master"),
          player.pseudonym
        ),

        type: "is-primary",
        hasIcon: true,
        iconPack: "fas",
        icon: "user-shield",

        onConfirm: () => {
          this.$store.dispatch("morel/switch_master", uuid);
        }
      })
    },

    kick_player(uuid) {
      if (!this.we_are_master || uuid === this.our_uuid) return

      let player = this.players[uuid]
      if (!player || !player.online) return

      const $t = this.$t.bind(this)

      let message = this.replace_name(
        this.kickConfirmMessage,
        this.locked
          ? $t("&lt;strong>{name}&lt;/strong> will be unable to join as long as the game is locked.")
          : $t("&lt;strong>{name}&lt;/strong> will left the game, but will be able to re-join as the game is not locked."),
        player.pseudonym
      )

      let help = this.replace_name(
        this.kickConfirmHelp,
        this.locked
          ? $t("To unlock the game, use the lock icon above the share game button.")
          : $t("You can lock the game with the lock icon above the share game button."),
        player.pseudonym
      )

      this.$buefy.dialog.confirm({
        title: this.replace_name(
          this.kickConfirmTitle,
          $t("Kick {name}?"),
          player.pseudonym
        ),
        message: `${message}&lt;br />&lt;br />&lt;span class="has-text-grey">${help}&lt;/span>`,
        confirmText: this.replace_name(
          this.kickConfirmButtonYes,
          $t("Kick"),
          player.pseudonym
        ),
        cancelText: this.replace_name(
          this.kickConfirmButtonNo,
          $t("I changed my mind"),
          player.pseudonym
        ),

        type: "is-danger",
        hasIcon: true,
        iconPack: "fas",
        icon: "user-alt-slash",

        onConfirm: () => {
          this.$store.dispatch("morel/kick_player", uuid);
        }
      })
    }
  },
  components: {
    "morel-player-action": PlayerAction
  }
}
&lt;/script>

&lt;style lang="sass">
@import "~bulma/sass/utilities/_all"

.panel.morel-players-list
  border-radius: 5px

  +mobile
    margin-left: 1rem
    margin-right: 1rem

  .panel-block
    align-items: center

    &amp;:first-child
      border-top-left-radius: 4px
      border-top-right-radius: 4px

    &amp;:last-child
      border-bottom-left-radius: 4px
      border-bottom-right-radius: 4px

    .panel-icon, .panel-icon-right
      display: inline-block
      position: relative
      top: -2px

      width: 1em
      height: 1em

    .panel-block-main
      flex: 2

    .ourself-mark
      display: inline-block
      margin-left: .4em
      padding-top: .3em

    .is-master
      font-weight: bold
    .is-offline
      font-style: italic

    &amp;:hover .morel-player-action-icon
      display: block

.dialog.modal .media-content p span
  font-weight: normal
&lt;/style>
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AskPseudonym.html">AskPseudonym</a></li><li><a href="module-Players.html">Players</a></li></ul><h3>Classes</h3><ul><li><a href="MorelClient.html">MorelClient</a></li><li><a href="MorelI18n.html">MorelI18n</a></li></ul><h3>Global</h3><ul><li><a href="global.html#MorelStore">MorelStore</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Thu May 07 2020 13:42:35 GMT+0200 (GMT+02:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
